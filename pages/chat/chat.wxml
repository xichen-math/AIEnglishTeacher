<view class="chat-container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="custom-nav">
    <view class="back-btn" bindtap="handleBack">
      <view class="back-icon"></view>
    </view>
    <view class="nav-title">AIè‹±è¯­æ•™å¸ˆ</view>
  </view>

  <!-- PPT æ˜¾ç¤ºåŒºåŸŸ -->
  <view class="ppt-container">
    <image class="ppt-slide" 
           src="{{currentSlide}}" 
           mode="aspectFit" 
           binderror="handleImageError" 
           bindload="handleImageLoad"></image>
    <canvas type="2d" id="pptCanvas" class="ppt-canvas" bindtap="handleCanvasClick"></canvas>
    <view class="ppt-controls">
      <view class="arrow-btn-container">
        <view class="arrow-btn prev" bindtap="prevSlide" hidden="{{currentIndex === 0}}">â—€</view>
      </view>
      <view class="arrow-btn-container">
        <view class="arrow-btn next" bindtap="nextSlide" hidden="{{currentIndex === slides.length - 1}}">â–¶</view>
      </view>
    </view>
    <view wx:if="{{showTrophy}}" class="trophy {{moveTrophy ? 'move' : ''}}" 
          style="left: {{trophyPosition.x}}px; top: {{trophyPosition.y}}px">ğŸ†</view>
    <view class="float-back-btn" bindtap="handleBack">
      <view class="back-icon"></view>
    </view>
    <view class="fullscreen-btn" bindtap="toggleFullscreen">â¤¢</view>
  </view>

  <!-- èŠå¤©åŒºåŸŸ -->
  <view class="chat-area" hidden="{{!showChat}}">
    <scroll-view class="chat-list" scroll-y="true" scroll-into-view="{{scrollToMessage}}" scroll-with-animation="true">
      <view class="message-list">
        <block wx:for="{{messages}}" wx:key="id">
          <view class="message {{item.type === 'ai' ? 'message-ai' : 'message-user'}}" id="msg-{{item.id}}">
            <view class="message-content">{{item.content}}</view>
          </view>
        </block>
      </view>
    </scroll-view>

    <!-- åº•éƒ¨æ“ä½œåŒº -->
    <view class="footer">
      <view class="input-area">
        <input class="text-input" 
               type="text" 
               placeholder="è¾“å…¥æ–‡å­—..." 
               value="{{inputText}}"
               bindinput="onInputChange"
               confirm-type="send"
               bindconfirm="sendTextMessage"/>
        <button class="send-button" bindtap="sendTextMessage" disabled="{{!inputText}}">å‘é€</button>
      </view>
      <view class="controls">
        <button class="end-button" bindtap="endChat">ç»“æŸå¯¹è¯</button>
      </view>
    </view>
  </view>
</view> 