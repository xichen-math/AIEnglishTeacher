<view class="chat-container">
  <!-- PPT播放区域 -->
  <view class="ppt-container {{isLoading ? 'loading' : ''}}">
    <block wx:if="{{!isLoading}}">
      <image class="ppt-slide" src="{{currentSlide}}" mode="aspectFit"></image>
      <view class="ppt-controls">
        <button class="ppt-btn" bindtap="prevSlide" disabled="{{currentIndex <= 0}}">上一页</button>
        <button class="ppt-btn" bindtap="toggleAutoPlay">{{isAutoPlaying ? '暂停' : '自动播放'}}</button>
        <button class="ppt-btn" bindtap="nextSlide" disabled="{{currentIndex >= slides.length-1}}">下一页</button>
      </view>
    </block>
    <view wx:else class="loading-container">
      <view class="loading-spinner"></view>
      <text>加载中...</text>
    </view>
  </view>

  <!-- 聊天消息列表 -->
  <scroll-view class="chat-list" scroll-y="true" scroll-into-view="{{scrollToMessage}}" scroll-with-animation="true">
    <view class="message-list">
      <block wx:for="{{messages}}" wx:key="id">
        <view class="message {{item.type === 'ai' ? 'message-ai' : 'message-user'}}" id="msg-{{item.id}}">
          <view class="message-content">{{item.content}}</view>
        </view>
      </block>
    </view>
  </scroll-view>

  <!-- 底部操作区 -->
  <view class="footer">
    <view class="input-area">
      <input class="text-input" 
             type="text" 
             placeholder="输入文字..." 
             value="{{inputText}}"
             bindinput="onInputChange"
             confirm-type="send"
             bindconfirm="sendTextMessage"/>
      <button class="send-button" bindtap="sendTextMessage" disabled="{{!inputText}}">发送</button>
    </view>
    <view class="controls">
      <button class="chat-button {{isRecording ? 'recording' : ''}}"
              bindtouchstart="startRecording"
              bindtouchend="stopRecording">
        {{isRecording ? '松开发送' : '按住说话'}}
      </button>
      <button class="end-button" bindtap="endChat">结束对话</button>
    </view>
  </view>
</view> 