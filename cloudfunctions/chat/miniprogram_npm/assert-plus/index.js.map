{"version":3,"sources":["assert.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["// Copyright (c) 2012, Mark Cavage. All rights reserved.\r\n// Copyright 2015 Joyent, Inc.\r\n\r\nvar assert = require('assert');\r\nvar Stream = require('stream').Stream;\r\nvar util = require('util');\r\n\r\n\r\n///--- Globals\r\n\r\n/* JSSTYLED */\r\nvar UUID_REGEXP = /^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$/;\r\n\r\n\r\n///--- Internal\r\n\r\nfunction _capitalize(str) {\r\n    return (str.charAt(0).toUpperCase() + str.slice(1));\r\n}\r\n\r\nfunction _toss(name, expected, oper, arg, actual) {\r\n    throw new assert.AssertionError({\r\n        message: util.format('%s (%s) is required', name, expected),\r\n        actual: (actual === undefined) ? typeof (arg) : actual(arg),\r\n        expected: expected,\r\n        operator: oper || '===',\r\n        stackStartFunction: _toss.caller\r\n    });\r\n}\r\n\r\nfunction _getClass(arg) {\r\n    return (Object.prototype.toString.call(arg).slice(8, -1));\r\n}\r\n\r\nfunction noop() {\r\n    // Why even bother with asserts?\r\n}\r\n\r\n\r\n///--- Exports\r\n\r\nvar types = {\r\n    bool: {\r\n        check: function (arg) { return typeof (arg) === 'boolean'; }\r\n    },\r\n    func: {\r\n        check: function (arg) { return typeof (arg) === 'function'; }\r\n    },\r\n    string: {\r\n        check: function (arg) { return typeof (arg) === 'string'; }\r\n    },\r\n    object: {\r\n        check: function (arg) {\r\n            return typeof (arg) === 'object' && arg !== null;\r\n        }\r\n    },\r\n    number: {\r\n        check: function (arg) {\r\n            return typeof (arg) === 'number' && !isNaN(arg);\r\n        }\r\n    },\r\n    finite: {\r\n        check: function (arg) {\r\n            return typeof (arg) === 'number' && !isNaN(arg) && isFinite(arg);\r\n        }\r\n    },\r\n    buffer: {\r\n        check: function (arg) { return Buffer.isBuffer(arg); },\r\n        operator: 'Buffer.isBuffer'\r\n    },\r\n    array: {\r\n        check: function (arg) { return Array.isArray(arg); },\r\n        operator: 'Array.isArray'\r\n    },\r\n    stream: {\r\n        check: function (arg) { return arg instanceof Stream; },\r\n        operator: 'instanceof',\r\n        actual: _getClass\r\n    },\r\n    date: {\r\n        check: function (arg) { return arg instanceof Date; },\r\n        operator: 'instanceof',\r\n        actual: _getClass\r\n    },\r\n    regexp: {\r\n        check: function (arg) { return arg instanceof RegExp; },\r\n        operator: 'instanceof',\r\n        actual: _getClass\r\n    },\r\n    uuid: {\r\n        check: function (arg) {\r\n            return typeof (arg) === 'string' && UUID_REGEXP.test(arg);\r\n        },\r\n        operator: 'isUUID'\r\n    }\r\n};\r\n\r\nfunction _setExports(ndebug) {\r\n    var keys = Object.keys(types);\r\n    var out;\r\n\r\n    /* re-export standard assert */\r\n    if (process.env.NODE_NDEBUG) {\r\n        out = noop;\r\n    } else {\r\n        out = function (arg, msg) {\r\n            if (!arg) {\r\n                _toss(msg, 'true', arg);\r\n            }\r\n        };\r\n    }\r\n\r\n    /* standard checks */\r\n    keys.forEach(function (k) {\r\n        if (ndebug) {\r\n            out[k] = noop;\r\n            return;\r\n        }\r\n        var type = types[k];\r\n        out[k] = function (arg, msg) {\r\n            if (!type.check(arg)) {\r\n                _toss(msg, k, type.operator, arg, type.actual);\r\n            }\r\n        };\r\n    });\r\n\r\n    /* optional checks */\r\n    keys.forEach(function (k) {\r\n        var name = 'optional' + _capitalize(k);\r\n        if (ndebug) {\r\n            out[name] = noop;\r\n            return;\r\n        }\r\n        var type = types[k];\r\n        out[name] = function (arg, msg) {\r\n            if (arg === undefined || arg === null) {\r\n                return;\r\n            }\r\n            if (!type.check(arg)) {\r\n                _toss(msg, k, type.operator, arg, type.actual);\r\n            }\r\n        };\r\n    });\r\n\r\n    /* arrayOf checks */\r\n    keys.forEach(function (k) {\r\n        var name = 'arrayOf' + _capitalize(k);\r\n        if (ndebug) {\r\n            out[name] = noop;\r\n            return;\r\n        }\r\n        var type = types[k];\r\n        var expected = '[' + k + ']';\r\n        out[name] = function (arg, msg) {\r\n            if (!Array.isArray(arg)) {\r\n                _toss(msg, expected, type.operator, arg, type.actual);\r\n            }\r\n            var i;\r\n            for (i = 0; i < arg.length; i++) {\r\n                if (!type.check(arg[i])) {\r\n                    _toss(msg, expected, type.operator, arg, type.actual);\r\n                }\r\n            }\r\n        };\r\n    });\r\n\r\n    /* optionalArrayOf checks */\r\n    keys.forEach(function (k) {\r\n        var name = 'optionalArrayOf' + _capitalize(k);\r\n        if (ndebug) {\r\n            out[name] = noop;\r\n            return;\r\n        }\r\n        var type = types[k];\r\n        var expected = '[' + k + ']';\r\n        out[name] = function (arg, msg) {\r\n            if (arg === undefined || arg === null) {\r\n                return;\r\n            }\r\n            if (!Array.isArray(arg)) {\r\n                _toss(msg, expected, type.operator, arg, type.actual);\r\n            }\r\n            var i;\r\n            for (i = 0; i < arg.length; i++) {\r\n                if (!type.check(arg[i])) {\r\n                    _toss(msg, expected, type.operator, arg, type.actual);\r\n                }\r\n            }\r\n        };\r\n    });\r\n\r\n    /* re-export built-in assertions */\r\n    Object.keys(assert).forEach(function (k) {\r\n        if (k === 'AssertionError') {\r\n            out[k] = assert[k];\r\n            return;\r\n        }\r\n        if (ndebug) {\r\n            out[k] = noop;\r\n            return;\r\n        }\r\n        out[k] = assert[k];\r\n    });\r\n\r\n    /* export ourselves (for unit tests _only_) */\r\n    out._setExports = _setExports;\r\n\r\n    return out;\r\n}\r\n\r\nmodule.exports = _setExports(process.env.NODE_NDEBUG);\r\n"]}