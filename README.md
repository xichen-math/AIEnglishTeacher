# AI 英语教师小程序

## 1. 项目目标与简介

*   **目标**: 开发一个功能完善、性能优秀、用户体验良好的 AI 英语教师微信小程序。
*   **简介**: 本项目是一个基于 AI 的英语学习微信小程序，旨在通过 AI 对话、课程学习等方式帮助用户提升英语口语和综合能力。利用微信云开发和 AI 能力，提供交互式的学习体验。

## 2. 功能架构

小程序主要包含以下功能模块：

*   **首页 (`pages/index/index`)**:
    *   应用的入口页面。
    *   可能包含功能导航、学习进度概览、推荐内容等。
    *   作为 TabBar 页面之一。
*   **课程页 (`pages/course/course`)**:
    *   展示可供学习的英语课程列表。
    *   用户可以在此选择和进入具体的课程学习。
    *   作为 TabBar 页面之一。
*   **AI 对话页 (`pages/chat/chat`)**:
    *   核心交互功能，用户可以与 AI 进行英语对话练习。
    *   集成微信同声传译插件 (`WechatSI`)，支持语音识别与输入。
    *   可能包含聊天记录、文本输入、语音输入切换等功能。
    *   调用 `chat` 云函数处理对话逻辑。
    *   调用 `voiceRecognition` 云函数处理语音识别。
*   **个人中心 (`pages/my/my`)**:
    *   展示用户相关信息。
    *   可能包含学习记录、账号设置、关于我们等。
    *   作为 TabBar 页面之一。
*   **其他潜在功能**:
    *   **OCR (`ocr` 云函数)**: 可能用于图片文字识别，例如拍照翻译或提取文本。
    *   **文件处理 (`getFileSystemManager` 权限)**: 可能涉及本地学习资料的缓存或管理。
    *   **音频处理 (`createInnerAudioContext` 权限, `ffmpeg` 依赖?)**: 支持语音播放、录制或处理。

## 3. 技术栈选型

*   **开发框架**: 微信小程序原生开发框架 (WXML, WXSS, JavaScript)。
*   **UI**: 微信小程序原生组件。未明确使用第三方 UI 库如 WeUI，可按需引入或自定义组件。
*   **后端服务**: 微信小程序云开发 (CloudBase)。
    *   **云函数 (`cloudfunctions/`)**:
        *   `chat`: 处理 AI 对话核心逻辑。
        *   `ocr`: 处理光学字符识别（OCR）请求。
        *   `voiceRecognition`: 处理语音识别请求。
        *   其他辅助/测试云函数。
    *   **云数据库/存储**: (推测) 用于存储用户信息、学习进度、课程数据等。
*   **AI 能力**:
    *   **对话**: 通过 `chat` 云函数调用外部大语言模型 API。
    *   **语音识别/合成**: 使用微信同声传译插件 (`WechatSI`) 和 `voiceRecognition` 云函数。
*   **状态管理**: 默认使用小程序全局变量 (`globalData`) 或页面/组件内部状态管理。可按需引入状态管理库。
*   **网络请求**: 主要使用 `wx.cloud.callFunction` 调用云函数。
*   **前端依赖**:
    *   `ffmpeg` (`^0.0.4`): 用途不明确，通常用于音视频处理。**建议确认此依赖是在小程序前端使用，还是仅用于本地开发环境或云函数环境。**

## 4. 目录结构 (主要)

```
.
├── cloudfunctions/           # 云函数目录
│   ├── chat/                 # AI 对话云函数
│   ├── ocr/                  # OCR 云函数
│   ├── voiceRecognition/     # 语音识别云函数
│   └── ...                   # 其他云函数和测试函数
├── pages/                    # 小程序页面
│   ├── index/                # 首页
│   ├── course/               # 课程页
│   ├── chat/                 # 对话页
│   └── my/                   # 个人中心页
├── app.js                    # 小程序入口逻辑
├── app.json                  # 全局配置 (页面、窗口、TabBar、插件等)
├── app.wxss                  # 全局样式
├── project.config.json       # 项目配置文件 (AppID, 云函数根目录等)
├── project.private.config.json # 项目私有配置文件
├── package.json              # 前端 npm 依赖 (包含 ffmpeg)
├── package-lock.json         # 前端 npm 依赖锁定文件
├── README.md                 # 项目说明文档 (本文档)
└── ...                       # 其他配置文件、资源文件等
```

## 5. 开发与运行

1.  **环境准备**:
    *   安装 [微信开发者工具](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)。
    *   Node.js 环境 (用于部分依赖安装和云函数本地调试)。
2.  **导入项目**:
    *   在微信开发者工具中选择 "导入项目"。
    *   选择项目根目录。
    *   填入或使用测试 AppID (`wx3ede14b6b32d0bca` 或替换为自己的 AppID)。
3.  **配置云开发环境**:
    *   开通微信云开发，获取环境 ID。
    *   在 `app.js` 或相关初始化文件中配置云环境 ID。
    *   如果云函数使用了外部依赖 (如 `ffmpeg`?)，确保在云函数目录下执行 `npm install` 并正确上传部署。
4.  **部署云函数**:
    *   在微信开发者工具的 "云开发" 控制台中，选择对应的云函数目录（如 `chat`, `ocr`, `voiceRecognition`），右键点击 "上传并部署：所有文件"。
5.  **运行与调试**:
    *   点击微信开发者工具的 "编译" 按钮进行预览和调试。
    *   使用真机调试以测试语音、文件等相关功能。

## 6. 开发注意事项与最佳实践

*   **权限管理**:
    *   已在 `project.config.json` 中声明 `getFileSystemManager` 和 `createInnerAudioContext` 权限。确保在使用相关 API 前调用 `wx.authorize` 获取用户授权。
*   **API 调用**:
    *   云函数调用和外部 API 请求需要进行错误处理和超时设置。
    *   考虑 AI 服务调用的成本和速率限制。
*   **性能优化**:
    *   按需进行分包加载，优化首页加载速度。
    *   合理使用缓存机制减少重复请求。
    *   避免在页面生命周期函数（`onLoad`, `onShow`）中执行过多同步或耗时操作。
*   **安全性**:
    *   对用户输入（特别是文本输入）进行必要的检查，防止潜在风险。
    *   敏感操作（如调用付费 AI 服务）应在云函数中完成，不在小程序端暴露密钥等信息。
*   **代码规范**:
    *   遵循清晰、模块化的代码组织方式。
    *   使用 JSDoc 或类似规范为函数和模块编写注释。
    *   保持 WXML、WXSS、JS 代码分离。
*   **用户体验**:
    *   提供清晰的加载状态和错误提示。
    *   优化语音输入的交互流程。
    *   遵循微信小程序设计指南。

## 7. 后续迭代与优化建议

*   **完善课程模块**: 增加课程内容、学习进度跟踪、单元测试等。
*   **优化对话体验**: 引入更自然的对话流程、上下文管理优化、多轮对话支持。
*   **增加学习工具**: 如单词本、语法检查、发音评测等。
*   **细化个人中心**: 提供更详细的学习报告、成就系统、个性化设置。
*   **引入 UI 库**: 如需更丰富的组件和统一风格，可考虑引入 WeUI 或其他成熟的小程序 UI 库。
*   **单元测试**: 为核心函数和模块编写单元测试，提高代码健壮性。
*   **`ffmpeg` 依赖确认**: 明确 `ffmpeg` 依赖的实际用途和位置（前端、本地开发、云函数），移除不必要的依赖。

---

**本文档基于项目文件分析生成，建议开发过程中持续更新。**